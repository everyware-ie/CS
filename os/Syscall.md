# 시스템콜

## System call(Syscall)

→ 커널이 자신의 기능을 함수 형태로 제공해주는 것

- 커널이 입력값의 검증, 권한의 확인, 작업 순서 제어 등 → 커널의 보호
- API를 통해 만들어진 프로그램들은 최종적으로 이 시스템콜을 호출하는 형태가 됨

## Dual Mode(이중 동작 모드)

→ 이중 동작 모드는 쉽게 말해 운영체제를 보호하기 위한 기법. 사용자와 운영체제는 시스템 자원을 공유하기 때문에 사용자에게 제한을 두지 않으면 사용자가 메모리 내의 주요 운영체제 자원을 망가뜨릴 위험이 생기게 됨.

즉, 운영체제의 원활한 작동과 기능을 위해서 사용자의 시스템 자원 접근을 제한하는 보호 장치가 필수임. 이러한 보호 장치가 바로 이중 동작 모드

이중 동작 모드의 기본 개념은 사용자가 접근할 수 없는 커널 모드, 사용자가 접근할 수 잇는 사용자 모드로 나누어 짐.

### 이중 동작 모드의 구조

![Untitled](https://melodic-droplet-c1f.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F3c793912-0294-456e-ba59-f7da91aea06d%2F703ebe7c-692e-4d0a-8853-983b5f38c2e0%2FUntitled.png?table=block&id=54b21e23-d92f-42df-b431-e0b3d42ccb9b&spaceId=3c793912-0294-456e-ba59-f7da91aea06d&width=960&userId=&cache=v2)

→ 이중 동작 모드는 사용자 모드와 커널 모드로 구성되어 있음. 커널 모드는 수퍼바이저 모드, 시스템 모드, 특권모드로도 불림. 이들은 각각 사용자를 위한 동작과 운영체제를 위한 동작을 담당. 

그림에서 볼 수 있듯이, 사용자가 사용하는 응용 프로그램은 사용자 모드에서 작동이 되어지게 됨. 그러다가 해당 프로그램이 운영체제에게 시스템 사용을 요청하게 되면 커널 모드로 바꿔서 요청된 시스템을 실행한 뒤에 다시 사용자 모드로 전환.

커널 모드와 사용자 모드를 구분 짓기 위해서 모드 비트(mode bit)라고 하는 하나의 비트가 컴퓨터의 하드웨어에 추가됨. 이 비트는 커널모드(0), 사용자 모드(1)를 나타냄. 모드 비트로 모드를 구분할 수 있음.

### 프로세스 제어

- 프로세스 생성 및 종료
- 메모리에 로드, 실행
- 프로세스 속성 값 확인, 지정
- wait 이벤트, signal 이벤트
- 메모리 할당
- ex) fork, wait, exec, exit, load 등

### 파일 조작

- 파일 생성, 파일 삭제
- 열기, 닫기
- 읽기, 쓰기, Reposition
- 파일 속성 값 확인, 지정
- ex) open, read, write, close, create, delete 등

### 장치 관리

- 디바이스 요청 및 해제
- 읽기, 쓰기, Reposition
- 디바이스 속성 확인, 지정
- 비 물리적인 디바이스 해제 및 장착

### 정보 관리

- 시간 확인, 시간 지정
- 시스템 데이터 확인, 지정
- 프로세스, 파일, 디바이스 속성 가져오기
- 프로세스, 파일, 디바이스 속성 설정하기
- ex) getpid, alarm, sleep 등

### 통신

- 커뮤니케이션 연결 생성 및 삭제
- 메시지 송신, 수신
- 상태 정보 전달
- remote 디바이스 해제 및 장착
- ex) pipe, mmap 등

### 보안

- Permission 획득
- Permission 설정
- ex) chmod, umask, chown

### 시스템 콜의 구분

커널은 내부적으로 시스템 콜을 구분하기 위해 기능별로 고유번호를 할당하고 그 번호에 해당하는 제어 루틴을 정의 → 요청받은 시스템 콜에 대응하는 고유번호 확인하고 번호에 맞는 서비스 루틴 호출